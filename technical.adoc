= Technical Documentation for Workout Tracker

This document provides technical details about the Workout Tracker application, a Flask-based web app for tracking workouts and measuring strength.

== Table of Contents
* Technologies Used
    ** Backend
    ** Frontend
* Application Structure
* Database Schema
* Functionality
* Future Plans
* Code
* Dependencies

For regular documentation go link:README.md[HERE]

== Technologies Used

=== Backend:

* **'Flask'**: Python web framework for building web applications.
* **'SQLite'**: Lightweight database for storing application data.

=== Frontend:

* **'HTML/CSS'**: For structuring and styling the user interface.
* **'JavaScript`**`: For adding interactivity to the user interface.

== Application Structure

The application is organized into the following components:

* **'app.py'**: Main Flask application file containing the routes, logic, and database interactions.
* **'templates/'**: Directory containing HTML templates for rendering the user interface.
* **'static/'**: Directory containing static assets like CSS, JavaScript, and images.
* **'strength.py'**: Module containing functions for calculating strength scores and percentiles.
* **'database.py'**: Module containing functions for interacting with the SQLite database.

== Database Schema

The application uses a SQLite database with the following tables:

* **'users'**: Stores user information like username, password, and optional profile data.
* **'exercises'**: Stores a list of exercises with their muscle group and targeted muscle information.
* **'workouts'**: Stores workout records for each user, including the date and exercises performed.

== Functionality

The Workout Tracker application provides the following features:

* **'User Authentication'**: Users can register and log in securely using usernames and passwords.
* **'Workout Tracking'**: Users can record and view their workouts, including the date and exercises performed.
* **'Exercise List'**: Users can browse a list of exercises categorized by muscle group and targeted muscle.
* **'Strength Tracking'**: Users can input their workout data to calculate estimated one-rep maximums and strength scores based on gender and body weight.

== Future Plans

Here are some potential future enhancements for the Workout Tracker application:

* **'Progress Tracking'**: Implement a progress page to visualize workout history and track improvements over time.

* **'User Profile Page`**`: Add a user profile page where users can manage their information and view their workout statistics.

== Code

=== HTML/JS

_**base.html**_

This is a base HTML template used in a Flask web application. It defines the basic structure of the web pages and includes common elements like the head, header, and main content area.

_head_
```html
<head>
    <meta charset="UTF-8" />
    <title>{{ subdomain_tag }} - Workout Tracker</title>
    <link rel="icon" href="{{ url_for('static', filename='images/icon.png') }}" />
    <link
        rel="stylesheet"
        href="{{ url_for('static', filename='style.css') }}"
    />
    <script src="{{ url_for('static', filename='script.js') }}"></script>
</head>
```
The head section of the base template includes the page title, favicon, CSS stylesheet, and JavaScript file. The page title is dynamically set based on the subdomain tag provided by the route. The favicon is a small icon displayed in the browser tab. The CSS stylesheet and JavaScript file are linked using the `url_for()` function to load the static assets from the `static` directory.

_header_
```html
<div id="header" style="display: flex; justify-content: center">
    <div id="banner" style="margin-left: 60px">
        <img
            src="{{ url_for('static', filename='images/logo.png') }}"
            alt="Banner"
            style="height: 60px; width: auto"
        />
    </div>
</div>
```

The header section of the base template includes a banner image with the Workout Tracker logo. The banner is centered on the page using flexbox and has a margin on the left side to align it with the sidebar.

_main_
```html
<main id="body">
    {% block main %}{% endblock %}
</main>
```

The main section of the base template includes a placeholder for the main content of the page. The content is defined in blocks that can be overridden by child templates.

_**home.js**_

This is a JavaScript file used in a Flask web application. It contains a function called `bmi()` that calculates the Body Mass Index (BMI) based on the weight and height entered by the user.

```javascript
function bmi() {
    var weight = document.getElementById("weight").value;
    var height = document.getElementById("height").value;
    var bmi = weight / (((height / 100) * height) / 100);
    document.getElementById("bmi").innerHTML = bmi.toFixed(2);
}
```

The function retrieves the weight and height values from the input fields with the IDs "weight" and "height". It then calculates the BMI using the formula `weight / (((height / 100) * height) / 100)`.

The `toFixed(2)` method is used to round the BMI value to two decimal places.

Finally, the function updates the innerHTML of an element with the ID "bmi" to display the calculated BMI value.

_**profile.js**_

This is a JavaScript file used in a Flask web application. It contains an event listener that listens for changes to an input field with the ID "profile_picture_link". It is used in a Flask web application. It contains a function called `toggleSidebar()` that toggles the width of a sidebar element between 60px and 170px. 

```javascript
var image_preview = document.getElementById("img_preview");
var image_input = document.getElementById("profile_picture_link");

image_input.addEventListener("input", function () {
    image_preview.src = this.value;
});
```


When the input field changes, the event listener updates the `src` attribute of an image element with the ID "img_preview" to display the selected image.

The `image_preview` variable stores a reference to the image element, and the `image_input` variable stores a reference to the input field.

The `addEventListener()` method is used to attach an event handler to the input field. The event handler function updates the `src` attribute of the image element to display the selected image.

_**script.js**_
```javascript
function toggleSidebar() {
    const sidebar = document.getElementById("sidebar");

    if (sidebar.style.width === "60px") {
        sidebar.style.width = "170px";
    } else {
        sidebar.style.width = "60px";
    }
}
```
The function retrieves the sidebar element using `document.getElementById("sidebar")`. It then checks the current width of the sidebar. If the width is 60px, it sets the width to 170px. If the width is 170px, it sets the width to 60px.

The function is typically called when a user clicks on a button or link to expand or collapse the sidebar.


_**workout.js**_

This is a JavaScript file used in a Flask web application. It contains several functions that handle the dynamic addition of workout sets, saving reps and weight data, and saving workout data.

The functions use DOM manipulation to create and update elements on the page dynamically based on user input.

```javascript
function addSetsFields() {
    const sets = document.getElementById("setsInput").value;
    const setsFieldsContainer = document.getElementById("setsFieldsContainer");
    const setsFields = document.createElement("div");
    setsFields.className = "setsFields";

    // Initialize the innerHTML with the first set
    setsFields.innerHTML =
        'Set 1 <label for="repsInput1">Reps:</label><input type="number" id="repsInput1" min="1" value="1"><label for="weightInput1">Weight:</label><input type="number" id="weightInput1" min="0" value="0">kg';

    // Add the remaining sets
    for (let i = 1; i < sets; i++) {
        const setNumber = i + 1;
        setsFields.innerHTML += `<br>Set ${setNumber} <label for="repsInput${setNumber}">Reps:</label><input type="number" id="repsInput${setNumber}" min="1" value="1"><label for="weightInput${setNumber}">Weight:</label><input type="number" id="weightInput${setNumber}" min="0" value="0">kg`;
    }

    // Add the save button
    setsFields.innerHTML +=
        '<br><button onclick="saveRepsWeight()">Save</button>';

    // Clear the container and add the new fields
    setsFieldsContainer.innerHTML = "";
    setsFieldsContainer.appendChild(setsFields);
}
```

The `addSetsFields()` function dynamically adds input fields for reps and weight based on the number of sets selected by the user. It creates a new `div` element with the class "setsFields" and populates it with input fields for each set. It also adds a "Save" button to save the reps and weight data.

```javascript
function saveRepsWeight() {
    const sets = document.getElementById("setsInput").value;
    const ListRepWeight = [];

    // Collect the reps and weight for each set
    for (let i = 1; i <= sets; i++) {
        const reps = document.getElementById(`repsInput${i}`).value;
        const weight = document.getElementById(`weightInput${i}`).value;
        ListRepWeight.push([reps, weight]);
    }

    // Clear the sets fields and display the exercise list
    const setsFieldsContainer = document.getElementById("setsFieldsContainer");
    setsFieldsContainer.innerHTML = "";

    const exerciseListContainer = document.getElementById("exercise-list");
    const exercise = document.getElementById("exerciseSelect").value;
    const exerciseList = document.createElement("div");
    exerciseList.className = "exerciseList";

    const List2 = ListRepWeight.map(
        (set, index) => `Set ${index + 1}: ${set[0]} reps, ${set[1]}kg`
    );

    exerciseList.innerHTML = `${exercise}<br> ${List2.join(", <br>")}`;
    exerciseListContainer.appendChild(exerciseList);
}
```

The `saveRepsWeight()` function collects the reps and weight data for each set and saves it to a list. It then displays the exercise list with the reps and weight data for each set.

```javascript
// Set the current date as the default value for the date input
document.getElementById("dateInput").valueAsDate = new Date();

function saveWorkout() {
    const date = document.getElementById("dateInput").value;
    const exerciseListContainer = document.getElementById("exercise-list");
    const exerciseList =
        exerciseListContainer.getElementsByClassName("exerciseList");
    const exercises = [];
    let name = document.getElementById("workoutName").value;

    if (name === "") {
        name = "Workout";
    }

    for (let index = 0; index < exerciseList.length; index++) {
        const exerciseText = exerciseList[index].innerText;
        const exerciseParts = exerciseText.split("\n");
        const exerciseName = exerciseParts[0];
        const sets = exerciseParts.slice(1).map((setText) => {
            const setTextParts = setText.split(", ");
            const reps = parseInt(setTextParts[0].split(" ")[2]);
            const weight = parseInt(setTextParts[1].split(" ")[0]);
            return [reps, weight];
        });
        exercises.push({ [exerciseName]: sets });
    }

    const dateInput = document.getElementById("date");
    const exercisesInput = document.getElementById("exercises");
    dateInput.value = date;
    exercisesInput.value = JSON.stringify({ [name]: exercises });

    document
        .getElementById("return-form")
        .getElementsByTagName("input")[2]
        .click();
}
```

The `saveWorkout()` function saves the workout data, including the date and exercise list, to hidden input fields in a form. It then submits the form to save the workout data to the database.

=== Python

ALL THE REST OF CODE FRAGMENTS WILL BE ADDED AS SOON AS I FINISH THEM FULLY.

== Dependencies

- Flask: Web framework for building the application.
- SQLite: Database management system for storing user, exercise, and workout data.
- Werkzeug: Library for password hashing and verification.
- Secrets: Library for generating secure random tokens.
- JSON: Data interchange format for storing strength standards.
- Numpy: Library for numerical computing and interpolation.
- Scipy: Library for scientific computing and interpolation.